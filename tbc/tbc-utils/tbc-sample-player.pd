#N canvas 25 94 1163 435 12;
#X obj 282 27 inlet bang;
#X obj 20 20 bng 30 250 50 0 \$0-pick-sample-s \$0-pick-sample-r Pick_sample
35 7 0 10 -232576 -1 -1;
#X obj 21 55 cnv 15 200 20 \$0-sample-name-s \$0-sample-name-r ...
0 12 0 14 -262144 -1 0;
#X obj 282 57 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#N canvas 0 50 810 441 (subpatch) 0;
#X array \$0-sample-L 326528 float 2;
#X coords 0 1 326528 -1 200 70 2 0 0;
#X restore 20 91 graph;
#X obj 919 27 inlet file-path;
#X obj 759 27 inlet pick-sample;
#X obj 759 122 s \$0-pick-sample-r;
#X obj 389 27 inlet pitch-hz;
#N canvas 0 50 450 250 (subpatch) 0;
#X array \$0-sample-R 326528 float 2;
#X coords 0 1 326528 -1 200 70 2 0 0;
#X restore 20 161 graph;
#X obj 282 252 outlet~ audio-L;
#X obj 454 251 outlet~ audio-R;
#X obj 11 359 s \$0-sample-crossfade-time;
#X obj 11 305 loadbang;
#X text 50 330 <-- Sample fade in / out ms;
#N canvas 354 213 729 689 load-file 0;
#X obj 268 130 openpanel;
#X obj 329 580 soundfiler;
#X obj 268 105 r \$0-pick-sample-s;
#X obj 286 338 s \$0-sample-name-r;
#X msg 286 308 label \$1;
#X text 368 132 Get the file name and display it;
#X obj 53 626 outlet file-path;
#X text 440 339 Send name to canvas for display;
#X text 501 576 Read sample into array;
#X obj 268 215 symbol;
#X obj 137 131 list-to-symbol;
#X obj 53 70 route bang;
#X obj 286 280 get-file-name;
#X obj 53 296 symbol;
#X obj 100 105 t b a;
#X obj 367 455 symbol \$0-sample-L;
#X obj 329 518 pack s s s;
#X obj 406 485 symbol \$0-sample-R;
#X obj 329 425 t a b b;
#X msg 329 549 read -resize \$1 \$2 \$3;
#X obj 53 32 inlet;
#X text 196 15 When we get a new path in the filepath inlet \, store
that path in the symbol objects \, and load the sample the sample.
When we get a bang in the file-path inlet \, only output the file name
\, but don't reload the sample.;
#X obj 329 640 s \$0-total-sample-size;
#X obj 345 610 r \$0-new-sample-size;
#X obj 362 195 r \$0-recorded-sample-file-name;
#X obj 269 382 sel NO_SAMPLE!;
#X connect 0 0 9 0;
#X connect 1 0 22 0;
#X connect 2 0 0 0;
#X connect 4 0 3 0;
#X connect 9 0 12 0;
#X connect 9 0 13 0;
#X connect 9 0 25 0;
#X connect 10 0 9 0;
#X connect 11 0 13 0;
#X connect 11 1 14 0;
#X connect 12 0 4 0;
#X connect 13 0 6 0;
#X connect 14 1 10 0;
#X connect 15 0 16 1;
#X connect 16 0 19 0;
#X connect 17 0 16 2;
#X connect 18 0 16 0;
#X connect 18 1 15 0;
#X connect 18 2 17 0;
#X connect 19 0 1 0;
#X connect 20 0 11 0;
#X connect 23 0 22 0;
#X connect 24 0 9 1;
#X connect 24 0 13 1;
#X connect 24 0 12 0;
#X connect 25 1 18 0;
#X restore 919 121 pd load-file;
#X obj 919 335 outlet file-path;
#X obj 1012 307 outlet array-name;
#N canvas 583 303 531 446 oneshot-play-sample 0;
#N canvas 32 150 729 700 play-sample 0;
#X obj 195 42 inlet length-ms;
#X obj 52 348 +~;
#X obj 411 434 *~;
#X obj 215 504 *~ 1;
#X obj 411 503 *~ 0;
#X obj 240 477 == 0;
#N canvas 688 187 1176 672 fade-in-and-out 0;
#X obj 276 552 outlet~;
#X msg 498 147 0;
#X obj 276 513 vline~;
#X msg 400 147 1;
#X msg 666 474 1, f 1;
#X text 681 298 Sample crossfade time (ms);
#X obj 276 315 t b b;
#X obj 684 321 r \$0-sample-crossfade-time;
#X obj 666 424 del;
#X text 296 18 This patch controls the fade in / out of a sample.;
#X obj 594 138 - 0;
#X obj 612 83 r \$0-sample-crossfade-time;
#X text 633 137 <-- Subtract fadeout time;
#X obj 432 212 f 0;
#X obj 594 183 clip 0 1e+017;
#X text 671 208 <-- If a 0 is recieved \, start fading out immediately
;
#X obj 498 118 del;
#X obj 400 84 inlet bang;
#X obj 498 84 inlet length;
#X obj 476 552 outlet~;
#X obj 476 513 vline~;
#X obj 432 267 sel 0;
#X text 397 314 Retrigger;
#X text 562 317 Stop;
#X text 223 317 Trigger;
#X obj 594 317 t b;
#X obj 400 177 t f b;
#X text 23 212 1 is sent when the delay has not finished \, so it is
a retrigger.;
#X text 400 212 --->;
#X text 23 192 0 is sent on fresh trigger.;
#X obj 464 315 t b b;
#N canvas 758 189 549 540 alternate-player 0;
#X obj 153 339 f;
#X obj 153 179 counter 2;
#X obj 153 203 sel 0 1;
#X msg 197 399 1 \$1 \$1;
#X msg 153 399 0 \$1;
#X msg 317 399 1 \$1 \$1;
#X msg 273 399 0 \$1;
#X obj 197 339 f;
#X obj 215 311 t f;
#X obj 153 478 outlet;
#X obj 273 478 outlet;
#X obj 32 80 inlet trigger;
#X obj 153 80 inlet retrigger;
#X obj 283 80 inlet stop;
#X obj 33 341 f;
#X obj 183 150 t b;
#X obj 32 105 t b b;
#X obj 283 105 t b b;
#X obj 415 341 f;
#X msg 415 399 0 \$1;
#X msg 455 399 0 \$1;
#X text 70 21 When we retrigger \, switch between the two tabread~
objects by fading one out \, and fading the other one in;
#X obj 33 365 t f f;
#X obj 384 80 inlet crossfade-time;
#X msg 33 396 1 0;
#X msg 73 396 0 0;
#X connect 0 0 4 0;
#X connect 0 0 5 0;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X connect 2 1 7 0;
#X connect 3 0 9 0;
#X connect 4 0 9 0;
#X connect 5 0 10 0;
#X connect 6 0 10 0;
#X connect 7 0 3 0;
#X connect 7 0 6 0;
#X connect 8 0 0 1;
#X connect 8 0 7 1;
#X connect 11 0 16 0;
#X connect 12 0 1 0;
#X connect 13 0 17 0;
#X connect 14 0 22 0;
#X connect 15 0 1 1;
#X connect 16 0 14 0;
#X connect 16 1 15 0;
#X connect 17 0 18 0;
#X connect 17 1 15 0;
#X connect 18 0 19 0;
#X connect 18 0 20 0;
#X connect 19 0 9 0;
#X connect 20 0 10 0;
#X connect 22 0 24 0;
#X connect 22 1 25 0;
#X connect 23 0 8 0;
#X connect 23 0 18 1;
#X connect 23 0 14 1;
#X connect 24 0 9 0;
#X connect 25 0 10 0;
#X restore 276 411 pd alternate-player;
#X obj 666 552 outlet;
#X obj 594 207 route 0;
#X obj 594 231 t b;
#X obj 640 233 del;
#X connect 1 0 13 1;
#X connect 2 0 0 0;
#X connect 3 0 26 0;
#X connect 4 0 32 0;
#X connect 6 0 31 0;
#X connect 6 1 4 0;
#X connect 7 0 31 3;
#X connect 7 0 8 1;
#X connect 8 0 4 0;
#X connect 10 0 14 0;
#X connect 11 0 10 1;
#X connect 13 0 21 0;
#X connect 14 0 33 0;
#X connect 16 0 1 0;
#X connect 17 0 3 0;
#X connect 18 0 10 0;
#X connect 18 0 16 0;
#X connect 20 0 19 0;
#X connect 21 0 6 0;
#X connect 21 1 30 0;
#X connect 25 0 31 2;
#X connect 26 0 13 1;
#X connect 26 1 13 0;
#X connect 30 0 31 1;
#X connect 30 1 8 0;
#X connect 31 0 2 0;
#X connect 31 1 20 0;
#X connect 33 0 34 0;
#X connect 33 1 35 0;
#X connect 34 0 25 0;
#X connect 35 0 25 0;
#X restore 52 227 pd fade-in-and-out;
#X obj 175 621 outlet~ left;
#X obj 411 621 outlet~ right;
#X obj 52 42 inlet bang;
#X obj 582 269 t f;
#X obj 582 42 inlet stereo-check;
#X obj 195 199 f;
#X obj 384 42 inlet start-position;
#X obj 405 101 r \$0-total-sample-size;
#X obj 384 177 *;
#X obj 405 126 t b f;
#X obj 195 67 sel 0;
#X msg 195 101 0;
#N canvas 0 81 596 132 comment 0;
#X text 50 44 0 as the input length tells the pd fade-in-and-out patch
to fade out the sample if it is currently playing.;
#X restore 266 100 pd comment;
#X obj 366 207 f;
#X obj 52 107 t b b b;
#X obj 227 128 t f f;
#X obj 175 308 sample-tabread4-stereo-instance \$0;
#X text 234 100 <---;
#X obj 215 327 sample-tabread4-stereo-instance \$0;
#X obj 215 434 *~;
#X obj 175 434 *~;
#X obj 112 348 +~;
#X obj 451 434 *~;
#X connect 0 0 17 0;
#X connect 1 0 27 1;
#X connect 1 0 2 1;
#X connect 2 0 4 0;
#X connect 3 0 8 0;
#X connect 4 0 8 0;
#X connect 5 0 3 1;
#X connect 6 0 1 0;
#X connect 6 1 28 0;
#X connect 6 2 23 0;
#X connect 6 2 25 0;
#X connect 9 0 21 0;
#X connect 10 0 4 1;
#X connect 10 0 5 0;
#X connect 10 0 23 3;
#X connect 10 0 25 3;
#X connect 11 0 10 0;
#X connect 12 0 6 1;
#X connect 13 0 15 0;
#X connect 14 0 16 0;
#X connect 15 0 20 1;
#X connect 16 0 15 0;
#X connect 16 1 15 1;
#X connect 17 0 18 0;
#X connect 17 1 22 0;
#X connect 18 0 12 0;
#X connect 20 0 23 2;
#X connect 20 0 25 2;
#X connect 21 0 6 0;
#X connect 21 1 12 0;
#X connect 21 2 20 0;
#X connect 22 0 12 0;
#X connect 22 1 23 1;
#X connect 22 1 25 1;
#X connect 23 0 27 0;
#X connect 23 1 2 0;
#X connect 25 0 26 0;
#X connect 25 1 29 0;
#X connect 26 0 3 0;
#X connect 26 0 7 0;
#X connect 27 0 3 0;
#X connect 27 0 7 0;
#X connect 28 0 26 1;
#X connect 28 0 29 1;
#X connect 29 0 4 0;
#X restore 62 237 pd play-sample;
#X obj 61 393 outlet~ left;
#X obj 191 393 outlet~ right;
#X obj 156 52 inlet length-ms;
#X obj 62 52 inlet bang;
#N canvas 482 396 798 411 check-if-stereo 0;
#X msg 158 126 0;
#X obj 74 126 until;
#X obj 74 181 tabread \$0-sample-R;
#X obj 48 303 f;
#X obj 74 151 f 0;
#X obj 109 151 + 1;
#X msg 74 259 1;
#X obj 48 91 t b f b;
#X obj 48 334 outlet;
#X text 273 47 To check if the sample is stereo \, loop through all
contents of the array \$0-sample-R and check if any value is anything
other than 0;
#X text 273 109 If it is \, then send a 1 out of the outlet \, otherwise
send 0;
#X obj 74 206 != 0;
#X obj 74 231 sel 1;
#X obj 48 26 r \$0-total-sample-size;
#X connect 0 0 3 1;
#X connect 0 0 4 1;
#X connect 1 0 4 0;
#X connect 2 0 11 0;
#X connect 3 0 8 0;
#X connect 4 0 5 0;
#X connect 4 0 2 0;
#X connect 5 0 4 1;
#X connect 6 0 3 1;
#X connect 7 0 3 0;
#X connect 7 1 1 0;
#X connect 7 2 0 0;
#X connect 11 0 12 0;
#X connect 12 0 6 0;
#X connect 13 0 7 0;
#X restore 171 207 pd check-if-stereo;
#X obj 290 52 inlet start-position;
#X connect 0 0 1 0;
#X connect 0 1 2 0;
#X connect 3 0 0 1;
#X connect 4 0 0 0;
#X connect 5 0 0 3;
#X connect 6 0 0 2;
#X restore 282 201 pd oneshot-play-sample;
#X obj 515 27 inlet sample-start-pos;
#X obj 565 47 inlet sample-length;
#X obj 615 67 inlet sample-rate;
#X obj 282 92 t b b;
#N canvas 199 206 711 732 calculate-play-time-ms 0;
#X obj 36 41 inlet bang;
#X obj 130 41 inlet pitch-hz;
#X obj 256 41 inlet sample-length;
#X obj 422 41 inlet sample-rate;
#X obj 130 691 outlet;
#X obj 151 375 * 1000;
#X floatatom 151 404 10 0 0 0 - - -;
#X obj 151 350 / 44100;
#X obj 151 605 * 1;
#X obj 172 552 swap 1;
#X obj 172 577 /;
#X obj 151 277 * 1;
#X obj 151 302 t f f;
#X obj 188 327 s \$0-sample-size;
#X obj 151 182 r \$0-total-sample-size;
#X obj 177 241 t b f;
#X obj 177 213 f;
#X obj 130 106 sel 0;
#X obj 151 650 spigot;
#X obj 196 621 != 0;
#X obj 372 557 t f;
#X obj 372 152 t f;
#X obj 130 66 t f f;
#X msg 130 650 0, f 1;
#X text 182 106 <-- Select out 0 so that we don't divide by 0;
#X text 238 621 <-- Turn off spigot if input is 0;
#X obj 167 435 t b f;
#X text 215 436 <--- Note! Before 0.8.1 this used to bang the multiplier
below \, but it would cause output every time the pitch was changed
\, even if the sample hadn't been banged. This would cause the sample
to not fade out \, and leave the audio out stuck at some value other
than 0 This change may be a source of bugs in the future. It seems
to work fine for now.;
#X obj 167 140 expr $f1 / 440;
#X connect 0 0 16 0;
#X connect 1 0 22 0;
#X connect 2 0 16 1;
#X connect 3 0 7 1;
#X connect 5 0 6 0;
#X connect 6 0 8 0;
#X connect 7 0 5 0;
#X connect 8 0 18 0;
#X connect 9 0 10 0;
#X connect 9 1 10 1;
#X connect 10 0 8 1;
#X connect 11 0 12 0;
#X connect 12 0 7 0;
#X connect 12 1 13 0;
#X connect 14 0 11 0;
#X connect 15 0 11 0;
#X connect 15 1 11 1;
#X connect 16 0 15 0;
#X connect 17 0 23 0;
#X connect 17 1 28 0;
#X connect 18 0 4 0;
#X connect 19 0 18 1;
#X connect 20 0 19 0;
#X connect 21 0 20 0;
#X connect 22 0 17 0;
#X connect 22 1 21 0;
#X connect 23 0 4 0;
#X connect 26 1 9 0;
#X connect 28 0 26 0;
#X restore 368 161 pd calculate-play-time-ms;
#X obj 919 146 t a b;
#X obj 1012 270 f \$0;
#X obj 1012 210 del 10;
#X msg 11 331 5;
#X connect 0 0 3 0;
#X connect 3 0 22 0;
#X connect 5 0 15 0;
#X connect 6 0 7 0;
#X connect 8 0 23 1;
#X connect 13 0 27 0;
#X connect 15 0 24 0;
#X connect 18 0 10 0;
#X connect 18 1 11 0;
#X connect 19 0 18 2;
#X connect 20 0 23 2;
#X connect 21 0 23 3;
#X connect 22 0 18 0;
#X connect 22 1 23 0;
#X connect 23 0 18 1;
#X connect 24 0 16 0;
#X connect 24 1 26 0;
#X connect 25 0 17 0;
#X connect 26 0 25 0;
#X connect 27 0 12 0;
#X coords 0 -1 1 1 220 230 2 10 10;
